div(class="salesmap dock",
  data-bind="css:{'r-show':contactVm,'settings-show':showSettings,'tools-show':showTools,'areas-show':showAreas,'new-area-show':showNewArea}")

  div(class="layers",data-bind="template:{name:layersVm.viewTmpl,data:layersVm}")

  //- div(id="loading-screen",ng-show="isLoading")
    div(id="loading-logo")

  //- div(id="map-canvas")
  div(class="map-canvas",data-bind="gmap:gmapVm")

  //- div(id="settings-button",ng-click="displaySettings()")
  //- div(id="tools-button",ng-click="displayTools()",ng-show="$site.hasPermission(['OFFICE_STATS','COMPANY_STATS'])")
  div(class="settings-btn",data-bind="cmd:toggleSettings")
  div(class="tools-btn",data-bind="cmd:toggleTools,visible:canTools")

  //- Settings/Filters panel
  div(class="dock-bottom settings-wrap")
    div(class="panel-close",data-bind="cmd:toggleSettings")

    //- Filter contacts already on the map
    div(id="map-filters")
      h2 Filters
      div Show contacts made in&nbsp;
        select(data-bind="options:teams,optionsText:'Name',value:selTeam")
        |&nbsp;by&nbsp;
        select(data-bind="options:teamReps,optionsText:'FullName',value:selRep")

      div(class="categories-filter")
        h3 Categories
          div(class="pill left lighter",data-bind="cmd:checkAllCategorys") Select all
          div(class="pill right",data-bind="cmd:checkNoCategorys") None
          div(class="pill float-right",data-bind="cmd:cmdEditCategorys") Edit

        div(class="filter-container")
          div(class="columns")
            div(data-bind="foreach:categorys")
              input(type="checkbox",data-bind="attr:{id:'c'+ID},checked:checked")
              label(data-bind="attr:{for:'c'+ID}")
                //- div needed for check mark
                div
                span(data-bind="text:Name")

      div(class="current-systems-filter")
        h3 Current Systems
          div(class="pill left lighter",data-bind="cmd:checkAllSystemTypes") Select all
          div(class="pill right",data-bind="cmd:checkNoSystemTypes") None

        div(class="filter-container")
          div(class="columns")
            div(data-bind="foreach:systemTypes")
              input(type="checkbox",data-bind="attr:{id:'st'+ID},checked:checked")
              label(data-bind="attr:{for:'st'+ID}")
                //- div needed for check mark
                div
                span(data-bind="text:CompanyName")


      div(class="iconmode-filter")
        h3 Map icons
        div(class="filter-container")
          div
            input(type="radio",name="iconmode",value="category",id="iconmode-ct",data-bind="checked:iconMode")
            label(for="iconmode-ct")
              //- div needed for check mark
              div
              | Use category icons on map
          div
            input(type="radio",name="iconmode",value="system",id="iconmode-st",data-bind="checked:iconMode")
            label(for="iconmode-st")
              //- div needed for check mark
              div
              | Use system logos on map

  div(class="dock-bottom tools-wrap")
    div(class="panel-close",data-bind="cmd:toggleTools")
    //- Manager tools
    div(id="option-icons")
      h2 Tools
      div(class="inline-icon",data-bind="cmd:editAreas")
        div(class="icon",id="edit-areas-icon")
        div(class="label") View/edit sales areas
      //- div(class="inline-icon",data-bind="cmd:displayContactTimeline()")
        div(class="icon",id="contact-timeline-icon")
        div(class="label") View contacts on timeline

  //- Edit areas main menu
  div(class="dock-bottom edit-areas-wrap")
    div(class="panel-close",data-bind="cmd:stopEditAreas")
    button(data-bind="cmd:newSalesArea") New area
    //- button(data-bind="cmd:saveSalesAreas(this)") Save
    //- button(data-bind="cmd:stopEditAreas",class="cancel") Exit edit mode


  //- Create/edit area panel
  div(class="dock-bottom new-area-wrap",data-bind="with:areasVm")
    //- div(id="edit-areas-new-panel",ng-class="{open:(mapMode=='areas'&&(SalesArea.mode=='new' || SalesArea.mode=='edit')),close:!(mapMode=='areas'&&(SalesArea.mode=='new' || SalesArea.mode=='edit'))}")
    form(name="newSalesAreaForm",data-bind="with:currArea")
      div(class="form-element")
        label Name:
        input(type="text",data-bind="ukov:data.Name,value:data.Name,valueUpdate:'keyup'")
        label Office:
        select(data-bind="options:$parent.teams,optionsText:'Name',value:$parent.selTeam")
        |&nbsp;Assigned to:&nbsp;
        select(data-bind="options:$parent.teamReps,optionsText:'FullName',value:$parent.selRep")
        |&nbsp;Start assignment on:&nbsp;
        input(type="text",placeholder="mm/dd/yyyy --:-- --",
          data-bind="ukov:data.StartTime,datetimevalue:data.StartTime,valueUpdate:'keyup'")
      div(class="footer-button-group")
        button(data-bind="cmd:$parent.saveCurrentSalesArea") Save
        button(data-bind="cmd:$parent.cancelCurrentSalesArea",class="cancel") Cancel
        button(data-bind="cmd:$parent.deleteCurrentSalesArea,visible:$parent.deleteCurrentSalesArea.canExecute",class="secondary") Delete



  //- Timeline view
  //- div(id="contact-timeline-panel",ng-class="{open:timelineIsDisplayed,close:!timelineIsDisplayed}")
    div(class="panel-close",ng-click="hideContactTimeline()")

    h2 Contacting Timeline
    div
      | From
      input(type="date",ng-model="ContactTimeline.startTimestamp")
      | to
      input(type="date",ng-model="ContactTimeline.endTimestamp")
      button(ng-click="ContactTimeline.refreshTimeline(this)",class="small") Go


    //- Filters
    div(id="contact-timeline-filter-summary")
      div(ng-click="ContactTimeline.displayFilters(this)") Filters
      div(ng-click="ContactTimeline.displayFilters(this)") {{ContactTimeline.getFiltersAsString(this)}}

      div(id="contact-timeline-filters-popup",ng-show="ContactTimeline.timelineFiltersAreDisplayed")
        h2 Filters
        div
          | Show contacts made in
          select(ng-model="officeId",ng-options="o.id as (o.id == 0 ? o.officeCity : (o.officeCity + ', ' + o.officeState)) for o in offices")
          span(ng-show="officeId")
            | by
            select(ng-model="salesRepId",ng-options="r.id as (r.firstName + ' ' + r.lastName) for r in salesReps | salesRepFilterByOffice:officeId")
        div(class="categories-filter")
          h3
            | Categories
            div(class="select-all",ng-click="selectAllCategories()") Select all
            div(class="select-none",ng-click="selectNoneCategories()") none
          div(class="filter-container")
            div(class="columns")
              div(ng-repeat="c in categories")
                input(type="checkbox",ng-model="c.visible",id="ct{{$index}}_2")
                label(for="ct{{$index}}_2") {{c.name}}


        div(class="current-systems-filter")
          h3
            | Current Systems
            div(class="select-all",ng-click="selectAllSystemTypes()") Select all
            div(class="select-none",ng-click="selectNoneSystemTypes()") none
          div(class="filter-container")
            div(class="columns")
              div(ng-repeat="s in systemTypes")
                input(type="checkbox",ng-model="s.visible",id="st{{$index}}_2")
                label(for="st{{$index}}_2") {{s.companyName}}


        div(class="button-container")
          button(ng-click="ContactTimeline.applyFilters(this)") Done


    //- Graph
    div(id="contact-timeline-container",graph-id="'contact-timeline'",graph-data="[]",graph-options="ContactTimeline.options",bar-graph)



  div(class="dock-right")
    //- div(class="btn-dock",data-bind="click:function(){showContact(!showContact())},toggle:{closed:!showContact()}")
      div(class="close")
      div(class="open")
    div(class="new-contact",data-bind="with:contactVm")
      h2 Homeowner notes
      form(name="contactForm")
        div(class="field")
          input(type="text",name="firstName",placeholder="First name",
            data-bind="ukov:data.FirstName,value:data.FirstName,valueUpdate:'keyup'")
        div(class="field")
          input(type="text",name="lastName",placeholder="Last name",
            data-bind="ukov:data.LastName,value:data.LastName,valueUpdate:'keyup'")
        div(class="field")
          input(type="text",name="fullAddress",placeholder="Address",
            data-bind="value:fullAddress,valueUpdate:'keyup'",readonly)
        div(class="field")
          label Category
            |&nbsp;
            span(class="fine-print link inverted",style="text-transform:initial;font-weight: 300;font-family:'Open Sans',sans-serif;",data-bind="cmd:$parent.cmdEditCategorys") Edit categories
          select(data-bind="options:$parent.categorys,optionsValue:'ID',optionsText:'Name',value:data.CategoryId")
          //- select(name="category",data-bind="data.CategoryId",ng-change="categoryChanged()",required)
            option(ng-repeat="c in categories",value="{{c.id}}",ng-selected="c.id==0") {{c.name}}
            option(value="new") Create a new category...
        div(class="field")
          label Current system
          select(data-bind="options:$parent.systemTypes,optionsValue:'ID',optionsText:'CompanyName',value:data.SystemId")
        div(class="field")
          label Notes
          textarea(name="note",data-bind="ukov:data.Note,value:data.Note,valueUpdate:'input'")
        div(class="field")
          label Follow up
          input(type="text",name="followup",placeholder="mm/dd/yyyy --:-- --",
            data-bind="ukov:data.FollowupOn,datetimevalue:data.FollowupOn,valueUpdate:'keyup'")
          //- input(type="datetime-local",name="followup",
            data-bind="ukov:data.FollowupOn,datepickervalue:data.FollowupOn")
          //- onchange="alert('asfd')")
        div(class="button-container")
          button(data-bind="cmd:cmdSave") Save
          button(class="cancel",data-bind="cmd:clickCancel") Cancel
